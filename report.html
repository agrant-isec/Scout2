<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>AWS Scout2 Report</title>

    <!-- Bootstrap core CSS -->
    <link href="inc-bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap theme -->
    <link href="inc-bootstrap/css/bootstrap-theme.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <!-- jQuery -->
    <script src="inc-jquery/jquery-1.11.2.min.js"></script>

    <!-- Handlebars -->
    <script src="inc-handlebars/handlebars-v3.0.0.js"></script>

    <!-- Scout2 -->
    <script src="inc-scout2/scout2.js"></script>
    <link href="inc-scout2/scout2.css" rel="stylesheet">

  </head>

  <body>

    <!-- Finding menu item partial -->
    <script id="finding_menu_item-partial" type="text/x-handlebars-template">
      {{#if items}}
        <li><a href="javascript:list_findings('{{finding_entity keyword_prefix entity}}', {{keyword_prefix}}_info['violations'], '{{@key}}')">
          {{description}} ({{items.length}})
        </a></li>
      {{/if}}
    </script>
    <script>
        Handlebars.registerPartial("finding_menu_item", $("#finding_menu_item-partial").html());
    </script>

    <!-- Generic dashboard partial -->
    <script id="dashboard-partial" type="text/x-handlebars-template">
      <div class="container">
        {{#grouped_each 3 items}}
          <div class="row">
            {{#each this}}
              <div class="col-sm-4">
                <div class="list-group-item finding-title-{{dashboard_color level checked_items flagged_items}} plain-link">
                  <a href="javascript:list_findings('{{finding_entity keyword_prefix entity}}', {{keyword_prefix}}_info['violations'], '{{@key}}')">
                    {{description}}
                  </a>
                </div>
                <div class="list-group-item">
                  <ul>
                    <li>{{friendly_name entity}} checked: {{checked_items}}</li>
                    <li>{{friendly_name entity}} flagged: {{flagged_items}}</li>
                  </ul>
                </div>
              </div>
            {{/each}}
          </div>
        {{/grouped_each}}
      </div>
    </script>
    <script>
      Handlebars.registerPartial("dashboard", $("#dashboard-partial").html());
    </script>

    <!-- CloudTrail trail partial -->
    <script id="cloudtrail_region-partial" type="text/x-handlebars-template">
      <div class="list-group" id="cloudtrail_region-details-{{name}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{name}}</h4>
        </div>
        <div class="list-group-item">
        <h4>Information</h4>
          <ul>
            {{#each trails}}
              <li class="list-group-item-text">Name: {{Name}}</li>
              <li class="list-group-item-text">Enabled: {{IsLogging}}</li>
              <li class="list-group-item-text">Enabled since: {{format_date StartLoggingTime}}</li>
              <li class="list-group-item-text">Stopped since: {{format_date StopLoggingTime}}</li>
              <li class="list-group-item-text">Include global services:
                <span id="cloudtrail_-global-services-duplicated-{{../name}}"><span id="cloudtrail_-no-global-services-{{../name}}">
                  {{#if IncludeGlobalServiceEvents}}True{{else}}False{{/if}}
                </span></span>
              </li>
              <li class="list-group-item-text">Destination S3 bucket name: <a href="javascript:showS3Bucket('{{S3BucketName}}')">{{S3BucketName}}</a>/{{S3KeyPrefix}}</li>
            {{else}}
               <li class="list-group-item-text">CloudTrail disabled</li>
            {{/each}}
             <li class="list-group-item-text">EC2 instances: {{count_ec2_in_region name "vpcs.instances"}}
          </ul>
        </div>
      </div>
    </script>
    <script>
      Handlebars.registerPartial("cloudtrail_region", $("#cloudtrail_region-partial").html());
    </script>

    <!-- EC2 attack surface item -->
    <script id="ec2_ip_grant-partial" type="text/x-handlebars-template">
      <li class="list-group-item-text">{{@key}}</li>
        <ul>
        {{#each cidrs}}
          <span class="ec2_attack_surface_item"><li class="list-group-item-text">{{this}}</li></span>
        {{/each}}
        </ul>
      </li>
    </script>
    <script>
        Handlebars.registerPartial("ec2_ip_grant", $("#ec2_ip_grant-partial").html());
    </script>

    <!-- EC2 ELB partial -->
    <script id="ec2_elb-partial" type="text/x-handlebars-template">
      <div class="list-group" id="ec2_elb-details-{{name}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{name}}</h4>
        </div>
        <div class="list-group-item">
          <h4>Network</h4>
          <ul>
            <li class="list-group-item-text">VPC: {{vpc_id}}</li>
            <li class="list-group-item-text">DNS: {{dns_name}}</li>
            <li class="list-group-item-text">Availability zones:</li>
            <ul>
              {{#each availability_zones}}
                <li class="list-group-item-text">{{this}}</li>
              {{/each}}
            </ul>
          </ul>
        </div>
        <div class="list-group-item">
          <h4>Listeners</h4>
          <ul>
          {{#each listeners}}
            <li class="list-group-item-text">
              {{load_balancer_port}} ({{protocol}}) <i class="glyphicon glyphicon-arrow-right"></i> {{instance_port}} ({{instance_protocol}})
              {{#if ssl_certificate_id}} :
                {{#each policy_names}}
                  <span id="ec2_elbs-old-ssl-policy-{{../../../name}}-{{this}}">{{this}}</span>
                {{/each}}
              {{/if}}
            </li>
          {{/each}}
          </ul>
        </div>
        <div class="list-group-item">
          <h4>Destination</h4>
          <ul>
            <li class="list-group-item-text">Security groups:  <span class="badge pull-right btn-info">{{count security_groups}}</span></li>
            <li class="list-group-item-text">Instances: <span class="badge pull-right btn-info">{{count instances}}</span></li>
            <li class="list-group-item-text">Subnets: <span class="badge pull-right btn-info">{{count subnets}}</span></li>
        </div>
      </div>
    </script>
    <script>
      Handlebars.registerPartial("ec2_elb", $("#ec2_elb-partial").html());
    </script>

    <!-- EC2 security group partials -->
    <script id="ec2_security_group-partial" type="text/x-handlebars-template">
      <div class="list-group" id="ec2_security_group-details-{{id}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{this.name}}</h4>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Information</h4>
          <div class="list-group-item-text item-margin">Description: {{description}}</div>
          <div class="list-group-item-text item-margin">ID: {{id}}</div>
        </div>
        {{> ec2_security_group-rule_list direction='Ingress' protocols=rules_ingress}}
        {{> ec2_security_group-rule_list direction='Egress' protocols=rules_egress}}
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Instances</h4>
          {{> ec2_security_group-instance_list instances=running-instances status='Running' region=region vpc=vpc group=id}}
          {{> ec2_security_group-instance_list instances=stopped-instances status='Stopped' region=region vpc=vpc group=id}}
        </div>
      </div>
    </script>
    <script>
        Handlebars.registerPartial("ec2_security_group", $("#ec2_security_group-partial").html());
    </script>
    <!-- EC2 security group instances partial -->
    <script id="ec2_security_group-instance_list-partial" type="text/x-handlebars-template">
      {{#if instances}}
        <div class="accordion">
          <h5 class="list-group-item-heading item-margin accordion-heading">{{status}}
            <a class="accordion-toggle" data-toggle="collapse" href="#ec2_security_group-{{group}}-instance_list-{{status}}">
              <span class="badge pull-right btn-info">{{instances.length}}</span>
            </a>
          </h5>
          <div id="ec2_security_group-{{group}}-instance_list-{{status}}" class="accordion-body collapse">
            <div class="accordion-inner">
              <ul class="no-bullet">
              {{#each instances}}
                <li class="list-group-item-text"><a href="javascript:showEC2Instance('{{../region}}','{{../vpc}}','{{this}}')">{{this}}</a></li>
              {{/each}}
              </ul>
            </div>
          </div>
        </div>
      {{else}}
        <h5 class="list-group-item-heading item-margin accordion-heading">{{status}}
          <span class="badge pull-right">{{instances.length}}</span>
        </h5>
      {{/if}}
    </script>
    <script>
      Handlebars.registerPartial("ec2_security_group-instance_list", $("#ec2_security_group-instance_list-partial").html());
    </script>
    <!-- EC2 security group rules partial -->
    <script id="ec2_security_group-rule_list-partial" type="text/x-handlebars-template">
      <div class="list-group-item">
        <h4 class="list-group-item-heading">{{direction}} Rules</h4>
        <ul>
        {{# each protocols}}
          <li class="list-group-item-text">{{name}}</li>
          <ul>
          {{# each rules}}
            <li class="list-group-item-text">Ports:
              <span id="ec2_security_groups-{{../name}}-{{ports}}-{{../../id}}">
                <span id="ec2_security_groups-ports-range-{{../../id}}-{{ports}}">
                  {{ports}}
                </span>
              </span>
            </li>
            <ul>
            {{# each grants/cidrs}}
              <li class="list-group-item-text">IP:
                <span id="ec2_security_groups-public-ports-{{../../../id}}-{{../ports}}">
                <span id="ec2_security_groups-non-elastic-ec2-public-ip-whitelisted-{{../../../id}}-{{this}}">
                <span id="ec2_security_groups-{{../../name}}-{{../ports}}-{{this}}-{{../../../id}}">
                  {{this}}
                </span></span></span>
              </li>
            {{/each}}
            {{# each grants/security_groups}}
              <li class="list-group-item-text"> EC2 security group:
                <span id="ec2_security_groups-{{../../name}}-{{../ports}}-{{this}}-{{../../../id}}">
                  <a href="javascript:findAndShowEC2Object('regions.vpcs.security_groups', '{{this}}')"> {{find_ec2_object_attribute "regions.vpcs.security_groups" this "name"}} ({{this}})</a>
                </span>
              </li>
            {{/each}}
            </ul>
          {{/each}}
          </ul>
        {{/each}}
        </ul>
      </div>
    </script>
    <script>
      Handlebars.registerPartial("ec2_security_group-rule_list", $("#ec2_security_group-rule_list-partial").html());
    </script>

    <!-- EC2 Network ACL partial -->
    <script id="ec2_network_acl-partial" type="text/x-handlebars-template">
        <div id="ec2_region-details-{{@key}}">
            <div class="list-group" id="ec2_network_acl-details-{{name}}">
            <div class="list-group-item active">
                <h4 class="list-group-item-heading">{{name}}</h4>
            </div>
            <div class="list-group-item">
                <h4 class="list-group-item-heading">Inbound rules</h4>
                {{{format_network_acls inbound_network_acls 'Source'}}}
            </div>
            <div class="list-group-item">
                <h4 class="list-group-item-heading">Outbound rules</h4>
                {{{format_network_acls outbound_network_acls 'Destination'}}}
            </div>
            </div>
        </div>
    </script>
    <script>
      Handlebars.registerPartial("ec2_network_acl", $("#ec2_network_acl-partial").html());
    </script>
    

    <!-- EC2 VPC partial -->
    <script id="ec2_vpc-partial" type="text/x-handlebars-template">
      <div class="list-group" id="ec2_vpc-details-{{id}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{name}}</h4>
        </div>
        <div class="list-group-item">
          <h4>Information</h4>
          <ul>
            <li class="list-group-item-text">Region: {{region}}</li>
            <li class="list-group-item-text">ID: {{id}}</li>
            <li class="list-group-item-text">Name: {{name}}</li>
          </ul>
        </div>
        <div class="list-group-item" style="padding-bottom: 0 !important;">
          <div class="accordion">
            <h4 class="list-group-item-heading accordion-heading">Network ACLs
              <a class="accordion-toggle" data-toggle="collapse" href="#ec2_vpc-{{id}}-network_acls"><span class="badge pull-right btn-info">{{count_vpc_network_acls network_acls}}</span></a>
            </h4>
            <div id="ec2_vpc-{{id}}-network_acls" class="accordion-body collapse">
              <div class="accordion-inner">
                <ul class="no-bullet">
                  {{#each network_acls}}
                    <li><a href="javascript:findAndShowEC2Object('regions.vpcs.network_acls', '{{@key}}')">{{@key}}</a></li>
                  {{/each}}
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="list-group-item" style="padding-bottom: 0 !important;">
          <div class="accordion">
            <h4 class="list-group-item-heading accordion-heading">Instances
              <a class="accordion-toggle" data-toggle="collapse" href="#ec2_vpc-{{id}}-instances"><span class="badge pull-right btn-info">{{count_vpc_instances instances}}</span></a>
            </h4>
            <div id="ec2_vpc-{{id}}-instances" class="accordion-body collapse">
              <div class="accordion-inner">
                <ul class="no-bullet">
                  {{#each instances}}
                    <li><a href="javascript:findAndShowEC2Object('regions.vpcs.instances', '{{@key}}')">{{@key}}</a></li>
                  {{/each}}
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </script>
    <script>
      Handlebars.registerPartial("ec2_vpc", $("#ec2_vpc-partial").html());
    </script>
    

    <!-- EC2 instance partial -->
    <script id="ec2_instance-partial" type="text/x-handlebars-template">
      <div class="list-group" id="ec2_instance-details-{{id}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{name}}</h4>
        </div>
        <div class="list-group-item">
          <h4>Information</h4>
          <ul>
            <li class="list-group-item-text">Region: {{region}}</li>
            <li class="list-group-item-text">ID: {{id}}</li>
            <li class="list-group-item-text">Reservation ID: {{reservation_id}}</li>
            <li class="list-group-item-text">Access Key name: {{key_name}}</li>
            <li class="list-group-item-text">State: {{state}}</li>
            <li class="list-group-item-text">Instance Type:
              <span id="ec2_instances-unscannable-instance-types-{{id}}"> {{instance_type}}<span>
            </li>
            <li class="list-group-item-text">Up since: {{launch_time}}</li>
          </ul>
        </div>
        <div class="list-group-item">
          <h4>Network</h4>
          <ul>
            <li class="list-group-item-text">Public IP: {{ip_address}}</li>
            <li class="list-group-item-text">Public DNS: {{public_dns_name}}</li>
            <li class="list-group-item-text">Private IP: {{private_ip_address}}</li>
            <li class="list-group-item-text">Private DNS: {{private_dns_name}}</li>
          </ul>
        </div>
        <div class="list-group-item" style="padding-bottom: 0 !important;">
          <div class="accordion">
            <h4 class="list-group-item-heading accordion-heading">Security groups
              <a class="accordion-toggle" data-toggle="collapse" href="#ec2_instance-{{id}}-security_groups"><span class="badge pull-right btn-info">{{security_groups.length}}</span></a>
            </h4>
            <div id="ec2_instance-{{id}}-security_groups" class="accordion-body collapse">
              <div class="accordion-inner">
                <ul class="no-bullet">
                  {{#each security_groups}}
                    <li><a href="javascript:findAndShowEC2Object('regions.vpcs.security_groups', '{{this}}')">{{this}}</a></li>
                  {{/each}}
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </script>
    <script>
      Handlebars.registerPartial("ec2_instance", $("#ec2_instance-partial").html());
    </script>

    <!-- IAM group partial -->
    <script id="iam_group-partial" type="text/x-handlebars-template">
      <div class="list-group" id="iam_group-details-{{name}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{name}}</h4>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Information</h4>
          <div class="list-group-item-text item-margin">Creation date: {{create_date}}</div>
        </div>
        <div class="list-group-item" style="padding-bottom: 0 !important;">
          <div class="accordion">
            <h4 class="list-group-item-heading accordion-heading">Members
              {{#if users}}
                <a class="accordion-toggle" data-toggle="collapse" href="#iam_group-{{name}}"><span class="badge pull-right btn-info">{{users.length}}</span></a>
              {{else}}
                <span class="badge pull-right">{{users.length}}</span>
              {{/if}}
            </h4>
            <div id="iam_group-{{name}}" class="accordion-body collapse">
              <div class="accordion-inner">
                <ul class="no-bullet">
                  {{#each users}}
                    <li><a href="javascript:showIAMUser('{{this}}')">{{this}}</a></li>
                  {{/each}}
                </ul>
              </div>
            </div>
          </div>
        </div>
        {{> iam_inline_policies entity_type = 'group'}}
        {{> iam_managed_policies}}
      </div>
    </script>
    <script>
      Handlebars.registerPartial("iam_group", $("#iam_group-partial").html());
    </script>

    <!-- IAM policy partial -->
    <script id="iam_policy-partial" type="text/x-handlebars-template">
      <hr>
      <div>
        <div class="accordion item-margin">
          <h5 class="list-group-item-heading accordion-heading">{{policy_name}}
            <a class="accordion-toggle" data-toggle="collapse" href="#iam_policy_details-{{report_id}}">
              <span class="badge pull-right btn-info">Details</span>
            </a>
          </h5>
          <div id="iam_policy_details-{{report_id}}" class="accordion-body collapse">
            <div class="accordion-inner">
              {{{displayPolicy policy_document 1}}}
            </div>
          </div>
        </div>
      </div>
    </script>
    <script>
      Handlebars.registerPartial("iam_policy", $("#iam_policy-partial").html());
    </script>

    <!-- IAM managed policies partial -->
    <script id="iam_managed_policies-partial" type="text/x-handlebars-template">
        <div class="list-group-item">
          {{#if managed_policies}}
            <h4 class="list-group-item-heading">Managed Policies <span class="badge pull-right btn-info">{{count managed_policies}}</span></h4>
          {{else}}
            <h4 class="list-group-item-heading">Managed Policies <span class="badge pull-right">{{count managed_policies}}</span></h4>
          {{/if}}
          <ul class="no-bullet">
          {{#each managed_policies}}
            <li class="list-group-item-text"><a href="javascript:showIAMManagedPolicy('{{this}}')">{{policy_friendly_name this}}</a></li>
          {{/each}}
          </ul>
        </div>
    </script>
    <script>
      Handlebars.registerPartial("iam_managed_policies", $("#iam_managed_policies-partial").html());
    </script>

    <!-- IAM inline policies partial -->
    <script id="iam_inline_policies-partial" type="text/x-handlebars-template">
        <div class="list-group-item">
          {{#if policies}}
            <h4 class="list-group-item-heading">Inline Policies <span class="badge pull-right btn-info">{{count policies}}</span></h4>
          {{else}}
            <h4 class="list-group-item-heading">Inline Policies <span class="badge pull-right">{{count policies}}</span></h4>
          {{/if}}
          {{#each policies}}
            {{policy_report_id this entity_type ../name @key}}
            {{> iam_policy policy_name = @key}}
          {{/each}}
        </div>
    </script>
    <script>
      Handlebars.registerPartial("iam_inline_policies", $("#iam_inline_policies-partial").html());
    </script>


    <!-- IAM role partial -->
    <script id="iam_role-partial" type="text/x-handlebars-template">
      <div class="list-group" id="iam_role-details-{{name}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{name}}</h4>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Information</h4>
          <div class="list-group-item-text item-margin">Creation date: {{create_date}}</div>
        </div>
        <div class="list-group-item">
          <div class="accordion">
            <h4 class="list-group-item-heading accordion-heading">Instances
              <a class="accordion-toggle" data-toggle="collapse" href="#iam_role_instances-{{name}}"><span class="badge pull-right btn-info">{{count_role_instances instance_profiles}}</span></a>
            </h4>
            <div id="iam_role_instances-{{name}}" class="accordion-body collapse">
              <div class="accordion-inner">
                <ul class="no-bullet">
                  {{#each instance_profiles}}
                    {{#each instances}}
                      <li><a href="javascript:findAndShowEC2Object('regions.vpcs.instances', '{{this}}')">{{this}}</a></li>
                    {{/each}}
                  {{/each}}
                </ul>
              </div>
            </div>
          </div>
        </div>
        {{> iam_inline_policies entity_type = 'role'}}
        {{> iam_managed_policies}}
      </div>
    </script>
    <script>
      Handlebars.registerPartial("iam_role", $("#iam_role-partial").html());
    </script>

    <!-- IAM user partial -->
    <script id="iam_user-partial" type="text/x-handlebars-template">
      <div class="list-group" id="iam_user-details-{{name}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{name}}</h4>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Information</h4>
          <div class="list-group-item-text item-margin">Creation date: {{create_date}}</div>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Authentication methods</h4>
          <p class="list-group-item-text item-margin">Password enabled: {{has_profiles? logins}}</p>
          <ul></ul>
          <p class="list-group-item-text item-margin">Multi-Factor enabled: <span id="iam_users-no-mfa-{{name}}">{{has_mfa? mfa_devices}}</span></p>
          <ul class="item-margin">
          {{#each mfa_devices}}
            <li class="list-group-item-text"> Serial number: {{serial_number}}</li>
          {{/each}}
          </ul>
          <p class="list-group-item-text item-margin">Access Keys: <span id="iam_users-multiple-active-keys-{{name}}">{{has_access_keys? access_keys}}</p><span>
          <ul class="item-margin">
          {{#each access_keys}}
            <li class="list-group-item-text"><span id="iam_users-{{status}}-key-no-rotation-{{../name}}-{{access_key_id}}">{{access_key_id}}, {{status}}, created on {{create_date}}</span></li>
          {{/each}}
          </ul>
          <p class="list-group-item-text item-margin">
            <span id="iam_users-multiple-active-keys-{{name}}" class="finding-hidden">
              <i class="glyphicon glyphicon-warning-sign"></i> Review the need for multiple active access keys
            </span>
          </p>
          <p class="list-group-item-text item-margin">
            <span id="iam_users-password-and-key-{{name}}" class="finding-hidden">
              <i class="glyphicon glyphicon-warning-sign"></i> Review the need for password-based and key-based authentication
            </span>
          </p>
          <p class="list-group-item-text item-margin">
            <span id="iam_users-not-in-global-iam-group-{{name}}" class="finding-hidden">
              <i class="glyphicon glyphicon-warning-sign"></i> User "{{name}}" does not belong to the global/mandatory IAM group
            </span>
          </p>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Groups</h4>
          <ul class="no-bullet">
          {{#each groups}}
            <li class="list-group-item-text"><a href="javascript:showIAMGroup('{{group_name}}')">{{group_name}}</a></li>
          {{/each}}
          </ul>
        </div>
        {{> iam_inline_policies entity_type = 'user'}}
        {{> iam_managed_policies}}
      </div>
    </script>
    <script>
      Handlebars.registerPartial("iam_user", $("#iam_user-partial").html());
    </script>

    <!-- RDS instance partial -->
    <script id="rds_instance-partial" type="text/x-handlebars-template">
      <div class="list-group" id="rds_instance-details-{{id}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{id}}</h4>
        </div>
        <div class="list-group-item">
          <h4>Information</h4>
          <ul>
            <li class="list-group-item-text">Region: {{region}}</li>
            <li class="list-group-item-text">Engine: {{engine}}</li>
            <li class="list-group-item-text">Status: {{status}}</li>
            <li class="list-group-item-text">Auto Minor Version Upgrade: <span id="rds_instances-no-minor-auto-upgrade-{{id}}">{{#if auto_minor_version_upgrade}} Yes {{else}} No {{/if}}</span></li>
            <li class="list-group-item-text">Multi Availability Zones: <span id="rds_instances-single-az-{{id}}">{{#if multi_az}} Yes {{else}} No {{/if}}</span></li>
            <li class="list-group-item-text">Instance Class: <span id="rds_instances-unscannable-instance-types-{{id}}"> {{instance_class}}<span></li>
            <li class="list-group-item-text">Created on: <span id="rds_instances-postgres-invalid-ssl-cert-{{id}}">{{create_time}}</span></li>
            <li class="list-group-item-tex">Backup retention period in days:
            <span id="rds_instances-backup-disabled-{{id}}">
            <span id="rds_instances-short-backup-retention-period-{{id}}">
              {{backup_retention_period}}
            </span>
            </span>
          </ul>
        </div>
        <div class="list-group-item">
          <h4>Network</h4>
          <ul>
            <li class="list-group-item-text">Endpoint: {{endpoint}}</li>
            <li class="list-group-item-text">Publicly accessible: {{PubliclyAccessible}}</li>
          </ul>
        </div>
      </div>
    </script>
    <script>
      Handlebars.registerPartial("rds_instance", $("#rds_instance-partial").html());
    </script>

    <!-- RDS security group partials -->
    <script id="rds_security_group-partial" type="text/x-handlebars-template">
      <div class="list-group" id="rds_security_group-details-{{name}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{name}}</h4>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Information</h4>
          <div class="list-group-item-text item-margin">Description: {{description}}</div>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Authorizations</h4>
          <ul>
            {{#each ec2_groups.owners}}
              {{#each groups}}
                <li class="list-group-item-text">
                  EC2 security group:
                  <a href="javascript:findAndShowEC2ObjectByAttr('regions.vpcs.security_groups', {'name': '{{this}}', 'owner_id': '{{@../key}}'})">{{this}} @ {{@../key}}</a>
                </li>
              {{/each}}
            {{/each}}
            {{#each ip_ranges}}
              <li class="list-group-item-text">IP: {{this}}</li>
            {{/each}}
          </ul>
        </div>
      </div>
    </script>
    <script>
        Handlebars.registerPartial("rds_security_group", $("#rds_security_group-partial").html());
    </script>

    <!-- S3 bucket partial -->
    <script id="s3_bucket-partial" type="text/x-handlebars-template">
      <div class="list-group" id="s3_bucket-details-{{name}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{name}}</h4>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Information</h4>
          <div class="list-group-item-text item-margin">Creation date: {{creation_date}}</div>
          <div class="list-group-item-text item-margin">Logging: <span id="s3_buckets-logging-disabled-{{name}}">{{has_logging? logging}}</span></div>
          <div class="list-group-item-text item-margin">Versioning: <span id="s3_buckets-versioning-disabled-{{name}}">{{versioning}}</span></div>
          <div class="list-group-item-text item-margin">Static website hosting: <span id="s3_buckets-static_website_hosting_enabled-{{name}}">{{web_hosting}}</span></div>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Permissions</h4>
          <table class="table-striped" width="100%" >
            <tr>
              <td width="20%"></td>
              <td width="20%" class="text-center">Read access</td>
              <td width="20%" class="text-center">Read permissions</td>
              <td width="20%" class="text-center">Write access</td>
              <td width="20%" class="text-center">Write permissions</td>
            </tr>
            {{#each grants}}
            <tr>
              <td width="20%">{{@key}}</td>
              <td width="20%" class="text-center">
                <span id="s3_buckets-{{name}}-read-{{../name}}">{{{s3_grant_2_icon this.read}}}</td></span>
              </td>
              <td width="20%" class="text-center">
                <span id="s3_buckets-{{name}}-read_acp-{{../name}}">{{{s3_grant_2_icon this.read_acp}}}</td></span>
              </td>
              <td width="20%" class="text-center">
                <span id="s3_buckets-{{name}}-write-{{../name}}">{{{s3_grant_2_icon this.write}}}</td></span>
              </td>
              <td width="20%" class="text-center">
                <span id="s3_buckets-{{name}}-write_acp-{{../name}}">{{{s3_grant_2_icon this.write_acp}}}</td></span>
              </td>
            </tr>
            {{/each}}
          </table>
        </div>
        {{#if policy}}
          <div class="list-group-item">
            <div class="accordion">
              <h4 class="list-group-item-heading accordion-heading">Policy
                <a class="accordion-toggle" data-toggle="collapse" href="#s3_bucket_policy_details-{{fixBucketName @key}}">
                  <span class="badge pull-right btn-info">Details</span>
                </a>
              </h4>
              <div id="s3_bucket_policy_details-{{fixBucketName @key}}" class="accordion-body item-margin collapse">
                <div class="accordion-inner">
                  {{{displayPolicy policy 0}}}
                </div>
              </div>
            </div>
          </div>
        {{/if}}
        {{#if keys}}
          <div class="list-group-item">
            <div class="accordion">
              <h4 class="list-group-item-heading accordion-heading">Keys
                <a class="accordion-toggle" data-toggle="collapse" href="#s3_bucket_keys-{{@key}}">
                  <span class="badge pull-right btn-info">{{count keys}}<span>
                </a>
              </h4>
              <div id="s3_bucket_keys-{{@key}}" class="accordion-body item-margin collapse">
                <div class="accordion-inner">
                  <table class="table-striped" width="100%" >
                    <tr>
                      <td width="80%">Name</td>
                      <td width="10%" class="text-center">Encrypted</td>
                      <td width="10%" class="text-center">Perms</td>
                    </tr>
                    {{#each keys}}
                    <tr>
                      <td width="80%"><a href="javascript:showS3Object('{{../name}}', '{{@key}}')">{{@key}}</a></td>
                      <td width="10%" class="text-center">
                        <span id="s3_buckets-unencrypted-s3-objects-{{../name}}-{{@key}}">
                          {{{good_bad_icon "unencrypted-s3-objects" ../name @key}}}
                        </span>
                      </td>
                      <td width="10%" class="text-center">
                        <span id="s3_buckets-object-perms-mismatch-bucket-perms-{{../name}}-{{@key}}">
                          {{{good_bad_icon "object-perms-mismatch-bucket-perms" ../name @key}}}
                        </span>
                      </td>
                    </tr>
                    {{/each}}
                  </table>
                </div>
              </div>
            </div>
          </div>
        {{/if}}
      </div>
    </script>
    <script>
      Handlebars.registerPartial("s3_bucket", $("#s3_bucket-partial").html());
    </script>

    <!-- S3 object partial -->
    <script id="s3_object-partial" type="text/x-handlebars-template">
      <div class="list-group" id="s3_object-details-{{name}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{bucket_name}}/{{name}}</h4>
        </div>
        <div class="list-gorup-item">
          <h4 class="list-group-item-heading">Information</h4>
          <div class="list-group-item-text">
            <ul class="no-bullet">
              <li>Server-side encryption: {{{good_bad_icon "unencrypted-s3-objects" bucket_name name}}}</li>
              <li>Permissions match bucket's: {{{good_bad_icon "object-perms-mismatch-bucket-perms" bucket_name name}}}</li>
            </ul>
          </div>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Permissions</h4>
          <table class="table-striped" width="100%" >
            <tr>
              <td width="20%"></td>
              <td width="20%" class="text-center">Read access</td>
              <td width="20%" class="text-center">Read permissions</td>
              <td width="20%" class="text-center">Write access</td>
              <td width="20%" class="text-center">Write permissions</td>
            </tr>
            {{#each grants}}
              <tr>
                <td width="20%">{{@key}}</td>
                <td width="20%" class="text-center">
                  <span id="s3_buckets-{{name}}-read-{{../name}}">{{{s3_grant_2_icon this.read}}}</td></span>
                </td>
                <td width="20%" class="text-center">
                  <span id="s3_buckets-{{name}}-read_acp-{{../name}}">{{{s3_grant_2_icon this.read_acp}}}</td></span>
                </td>
                <td width="20%" class="text-center">
                  <span id="s3_buckets-{{name}}-write-{{../name}}">{{{s3_grant_2_icon this.write}}}</td></span>
                </td>
                <td width="20%" class="text-center">
                  <span id="s3_buckets-{{name}}-write_acp-{{../name}}">{{{s3_grant_2_icon this.write_acp}}}</td></span>
                </td>
              </tr>
            {{/each}}
          </table>
        </div>
      </div>
    </script>
    <script>
      Handlebars.registerPartial("s3_object", $("#s3_object-partial").html());
    </script>


    <!-- Close popup button -->
    <script id="close_button-template" type="text/x-handlebars-template">
      <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
    </script>
    <script>
      var close_button_template = Handlebars.compile($("#close_button-template").html());
    </script>

    <!-- Single EC2 instance template -->
    <script id="single_ec2_instance-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> ec2_instance}}
    </script>
    <script>
        var single_ec2_instance_template = Handlebars.compile($("#single_ec2_instance-template").html());
    </script>

    <!-- Single EC2 VPC template -->
    <script id="single_ec2_vpc-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> ec2_vpc}}
    </script>
    <script>
        var single_ec2_vpc_template = Handlebars.compile($("#single_ec2_vpc-template").html());
    </script>
    
    <!-- Single EC2 Network ACL template -->
    <script id="single_ec2_network_acl-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> ec2_network_acl}}
    </script>
    <script>
        var single_ec2_network_acl_template = Handlebars.compile($("#single_ec2_network_acl-template").html());
    </script>

    <!-- Single EC2 security group template -->
    <script id="single_ec2_security_group-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> ec2_security_group}}
    </script>
    <script>
        var single_ec2_security_group_template = Handlebars.compile($("#single_ec2_security_group-template").html());
    </script>

    <!-- Single IAM group template -->
    <script id="single_iam_group-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> iam_group}}
    </script>
    <script>
        var single_iam_group_template = Handlebars.compile($("#single_iam_group-template").html());
    </script>

    <!-- Single IAM policy template -->
    <script id="single_iam_policy-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> iam_policy}}
        <hr>
    </script>
    <script>
        var single_iam_policy_template = Handlebars.compile($("#single_iam_policy-template").html());
    </script>

    <!-- Single IAM role template -->
    <script id="single_iam_role-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> iam_role}}
    </script>
    <script>
        var single_iam_role_template = Handlebars.compile($("#single_iam_role-template").html());
    </script>

    <!-- Single IAM user template -->
    <script id="single_iam_user-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> iam_user}}
    </script>
    <script>
        var single_iam_user_template = Handlebars.compile($("#single_iam_user-template").html());
    </script>

    <!-- Single S3 bucket template -->
    <script id="single_s3_bucket-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> s3_bucket}}
    </script>
    <script>
        var single_s3_bucket_template = Handlebars.compile($("#single_s3_bucket-template").html());
    </script>

    <!-- Single S3 object template -->
    <script id="single_s3_object-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> s3_object}}
    </script>
    <script>
      var single_s3_object_template = Handlebars.compile($("#single_s3_object-template").html());
    </script>

    <!-- Fixed navbar -->
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <span class="navbar-brand">AWS Scout</span>
        </div>
        <div class="navbar-collapse collapse">
          <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown">
              <a href="javascript:show_cloudtrail()" class="dropdown-toggle" data-toggle="dropdown"><span id="cloudtrail_dropdown">CloudTrail</span><b class="caret"></b></a>
              <ul class="dropdown-menu" id="cloudtrail_violations-list">
                <li class="dropdown-header">CloudTrail config</li>
                <li id="cloudtrail_load_button"><a href="javascript:load_config('cloudtrail')">Load</a></li>
                <script id="cloudtrail_violation-list-template" type="text/x-handlebars-template">
                  <li class="dropdown-header">CloudTrail config</li>
                  <li><a href="javascript:list_generic('cloudtrail_region')">Trails</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Summaries</li>
                  <li><a href="javascript:list_generic('cloudtrail_dashboard')">Dashboard</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Security risks</li>
                  {{#each items}}
                    {{> finding_menu_item}}
                  {{/each}}
                </script>
              </ul>
            </li>
            <li class="dropdown">
              <a href="javascript:show_ec2()" class="dropdown-toggle" data-toggle="dropdown"><span id="ec2_dropdown">EC2</span><b class="caret"></b></a>
              <ul class="dropdown-menu" id="ec2_violations-list">
                <li class="dropdown-header">EC2 config</li>
                <li id="ec2_load_button"><a href="javascript:load_config('ec2')">Load</a></li>
                <script id="ec2_violation-list-template" type="text/x-handlebars-template">
                  <li class="dropdown-header">EC2 config</li>
                  <li><a href="javascript:list_generic('ec2_elb')">ELBs</a></li>
                  <li><a href="javascript:list_generic('ec2_instance')">Instances</a></li>
                  <li><a href="javascript:list_generic('ec2_vpc')">VPCs</a></li>
                  <li><a href="javascript:list_generic('ec2_network_acl')">Network ACLs</a></li>
                  <li><a href="javascript:list_generic('ec2_security_group')">Security Groups</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Summaries</li>
                  <li><a href="javascript:list_generic('ec2_dashboard')">Dashboard</a></li>
                  <li><a href="javascript:list_generic('ec2_attack_surface')">External Attack Surface</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Security risks</li>
                  {{#each items}}
                    {{> finding_menu_item}}
                  {{/each}}
                </script>
              </ul>
            </li>
            <li class="dropdown">
              <a href="javascript:show_iam()" class="dropdown-toggle" data-toggle="dropdown"><span id="iam_dropdown">IAM</span><b class="caret"></b></a>
              <ul class="dropdown-menu" id="iam_violations-list">
                <li class="dropdown-header">IAM config</li>
                <li id="iam_load_button"><a href="javascript:load_config('iam')">Load</a></li>
                <script id="iam_violation-list-template" type="text/x-handlebars-template">
                  <li class="dropdown-header">IAM config</li>
                  <li><a href="javascript:list_generic('iam_group')">Groups</a></li>
                  <li><a href="javascript:list_generic('iam_role')">Roles</a></li>
                  <li><a href="javascript:list_generic('iam_credential_report')">Root account</a></li>
                  <li><a href="javascript:list_generic('iam_user')">Users</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Summaries</li>
                  <li><a href="javascript:list_generic('iam_dashboard')">Dashboard</a></li>
                  <li><a href="javascript:list_generic('iam_permission')">Permissions</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Security risks</li>
                  {{#each items}}
                    {{> finding_menu_item}}
                  {{/each}}
                </script>
              </ul>
            </li>
            <li class="dropdown">
              <a href="javascript:show_rds()" class="dropdown-toggle" data-toggle="dropdown"><span id="rds_dropdown">RDS</span><b class="caret"></b></a>
              <ul class="dropdown-menu" id="rds_violations-list">
                <li class="dropdown-header">RDS config</li>
                <li id="rds_load_button"><a href="javascript:load_config('rds')">Load</a></li>
                <script id="rds_violation-list-template" type="text/x-handlebars-template">
                  <li class="dropdown-header">RDS config</li>
                  <li><a href="javascript:list_generic('rds_instance')">Instances</a></li>
                  <li><a href="javascript:list_generic('rds_security_group')">Security Groups</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Summaries</li>
                  <li><a href="javascript:list_generic('rds_dashboard')">Dashboard</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Security risks</li>
                  {{#each items}}
                    {{> finding_menu_item}}
                  {{/each}}
                </script>
              </ul>
            </li>
            <li class="dropdown">
              <a hreaf="javascript:show_s3()" class="dropdown-toggle" data-toggle="dropdown"><span id="s3_dropdown">S3</span><b class="caret"></b></a>
              <ul class="dropdown-menu" id="s3_violations-list">
                <li class="dropdown-header">S3 config</li>
                <li><a href="javascript:load_config('s3')">Load</a></li>
                <script id="s3_violation-list-template" type="text/x-handlebars-template">
                  <li class="dropdown-header">S3 config</li>
                  <li><a href="javascript:list_generic('s3_bucket')">Buckets</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Summaries</li>
                  <li><a href="javascript:list_generic('s3_dashboard')">Dashboard</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Security risks</li>
                  {{#each items}}
                    {{> finding_menu_item}}
                  {{/each}}
                </script>
              </ul>
            </li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Regions<b class="caret"></b></a>
              <ul class="dropdown-menu" id="region-filters-list">
                <script id="region-filter-list-template" type="text/x-handlebars-template">
                  <li id="{{finding_entity keyword "region"}}-filter-select_none"><a href="javascript:clear_all_regions('{{keyword}}')">Hide all</a></li>
                  <li id="{{finding_entity keyword "region"}}-filter-select_all"><a href="javascript:select_all_regions('{{keyword}}')">Select all</a></li>
                  {{#each items}}
                    <li id="{{finding_entity ../keyword "region"}}-filter-{{name}}"><a href="javascript:toggle_region('{{../keyword}}', '{{name}}')"><i id="{{finding_entity ../keyword "region"}}-filtericon-{{name}}" class="glyphicon glyphicon-check""></i> {{name}}</a></li>
                  {{/each}}
                </script>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Filters<b class="caret"></b></a>
              <ul class="dropdown-menu" id="filters-list">
                <script id="filter-list-template" type="text/x-handlebars-template">
                  {{#each items}}
                    <li id="{{finding_entity keyword_prefix entity}}-filter-{{@key}}"><a href="javascript:toggle_filter({{keyword_prefix}}_info, '{{@key}}')"><i id="{{finding_entity keyword_prefix entity}}-filtericon-{{@key}}" class="glyphicon glyphicon-unchecked""></i> {{description}} ({{items.length}})</a></li>
                  {{/each}}
                </script>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Help<b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="javascript:about()">About AWS Scout2</a></li>
              </ul>
            </li>
          </ul>
          </div>
        </div><!--/.nav-collapse -->
      </div>

    </div>

    <div class="container theme-showcase" id="container-user">

      <div class="page-header">
      </div>

      <!-- Overlay divs used to show entity details in pop up -->
      <div id="overlay-background" class="overlay-bg"></div>
      <div id="overlay-details" class="overlay col-sm-6"></div>

      <!-- Section Title -->
      <div id="section_title-div">
          <h2 id="section_title-h2"></h2>
      </div>

      <!-- Dashboards -->
      <div class="row" id="cloudtrail_dashboards-row">
        <div class="col-sm-12" id="cloudtrail_dashboards-list">
          <script id="cloudtrail_dashboard-list-template" type="text/x-handlebars-template">
            {{> dashboard service_name = 'cloudtrail'}}
          </script>
        </div>
      </div>
      <div class="row" id="ec2_dashboards-row">
        <div class="col-sm-12" id="ec2_dashboards-list">
          <script id="ec2_dashboard-list-template" type="text/x-handlebars-template">
            {{> dashboard service_name = 'ec2'}}
          </script>
        </div>
      </div>
      <div class="row" id="iam_dashboards-row">
        <div class="col-sm-12" id="iam_dashboards-list">
          <script id="iam_dashboard-list-template" type="text/x-handlebars-template">
            {{> dashboard service_name = 'iam'}}
          </script>
        </div>
      </div>
      <div class="row" id="rds_dashboards-row">
        <div class="col-sm-12" id="rds_dashboards-list">
          <script id="rds_dashboard-list-template" type="text/x-handlebars-template">
            {{> dashboard service_name = 'rds'}}
          </script>
        </div>
      </div>
      <div class="row" id="s3_dashboards-row">
        <div class="col-sm-12" id="s3_dashboards-list">
          <script id="s3_dashboard-list-template" type="text/x-handlebars-template">
            {{> dashboard service_name = 's3'}}
          </script>
        </div>
      </div>

      <!-- Template for CloudTrail -->
      <div class="row" id="cloudtrail_regions-row">
        <div class="col-sm-4" id="cloudtrail_regions-list">
          <script id="cloudtrail_region-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('cloudtrail_region')">Show all<span class="badge pull-right">{{count_in 'cloudtrail' 'regions'}}</span></a></li>
            </ul>
            {{#each items}}
              <ul class="list-group" id="cloudtrail_region-list-{{@key}}">
                <li class="list-group-item active">
                  {{@key}} <span class="badge pull-right">{{count_ec2_in_region @key "vpcs.instances"}} instances </span>
                </li>
                {{#each trails}}
                  <div class="list-group-item list-sub-element">
                    <a href="javascript:browseTo('cloudtrail_region', '{{../name}}')">{{../name}}</a>
                  </div>
                {{else}}
                  <div class="list-group-item list-sub-element">
                    <span id="cloudtrail_regions-Service disabled-{{@key}}">CloudTrail disabled</span>
                  </div>
                {{/each}}
              </ul>
            {{/each}}
          </script>
        </div>
        <div class="col-sm-8" id="cloudtrail_regions-details">
          <script id="cloudtrail_region-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            {{> cloudtrail_region}}
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for network attack surface -->
      <div class="row" id="ec2_attack_surfaces-row">
        <div id="ec2_attack_surfaces-list">
          <script id="ec2_attack_surface-list-template" type="text/x-handlebars-template">
            <div class="list-group">
              <div class="row list-group-item active">
                <div class="col-sm-4"><h4>Public IP address</h4></div>
                <div class="col-sm-4"><h4>Open ports</h4></div>
                <div class="col-sm-4 pull-right"><h4><form>Filter by external IP:</h4> <input type="text" id="ec2_attack_surface_item_filter" onkeyup="filter_items('span', 'ec2_attack_surface_item')"></form></div>
              </div>
              {{#each items}}
                <div class="row list-group-item">
                  <div class="col-sm-4">{{@key}}</div>
                  <div class="col-sm-8">
                    <ul>
                    {{#each protocols ip = @key}}
                      <li class="list-group-item-text">{{@key}}</li>
                      <ul>
                      {{#each this}}
                        {{> ec2_ip_grant}}
                      {{/each}}
                      </ul>
                    {{/each}}
                    </ul>
                  </div>
                </div>
              {{/each}}
            </div>
          </script>
        </div>
      </div>

      <!-- Template for EC2 ELBs -->
      <div class="row" id="ec2_elbs-row">
        <div class="col-sm-4" id="ec2_elbs-list">
          <script id="ec2_elb-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('ec2_elb')">Show all<span class="badge pull-right">{{count_in "ec2" "regions.elbs"}}</span></a></li>
            </ul>
            {{#each items}}
             {{#if elbs}}
              <ul class="list-group">
                <li class="list-group-item active">{{@key}}</li>
                {{#each elbs}}
                  <div class="list-group-item list-sub-element" id="ec2_elb-list-{{@key}}"><a href="javascript:browseTo('ec2_elb', '{{@key}}')">{{@key}}</a></div>
                {{/each}}
              </ul>
             {{/if}}
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="ec2_elbs-details">
          <script id="ec2_elb-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            {{#each elbs}}
              {{> ec2_elb}}
            {{/each}}
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for EC2 security groups -->
      <div class="row" id="ec2_security_groups-row">
        <div class="col-sm-4" id="ec2_security_groups-list">
          <script id="ec2_security_group-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('ec2_security_group')">Show all<span class="badge pull-right">{{count_in "ec2" "regions.vpcs.security_groups"}}</span></a></li>
            </ul>
            {{#each items}}
              <div id="ec2_region-list-{{@key}}"> 
                {{#if vpcs}}
                  <ul class="list-group">
                    <li class="list-group-item active">{{@key}}</li>
                    {{#each vpcs}}
                      <div class="list-group-item list-sub-element">
                        {{name}}
                        {{#each security_groups}}
                          <div class="list-group-item-text list-sub-element" id="security_group-list-{{id}}"><a href="javascript:browseTo('ec2_security_group', '{{id}}')">{{name}}</a></div>
                        {{/each}}
                      </div>
                    {{/each}}
                  </ul>
                {{/if}}
              </div>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="ec2_security_groups-details">
          <script id="ec2_security_group-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            <div id="ec2_region-details-{{@key}}">
              {{#each vpcs}}
                {{#each security_groups}}
                  {{> ec2_security_group region=../../name vpc=../id }}
                {{/each}}
              {{/each}}
            </div>
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for EC2 network ACLs -->
      <div class="row" id="ec2_network_acls-row">
        <div class="col-sm-4" id="ec2_network_acls-list">
          <script id="ec2_network_acl-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('ec2_network_acl')">Show all<span class="badge pull-right">{{count_in "ec2" "regions.vpcs.network_acls"}}</span></a></li>
            </ul>
            {{#each items}}
              <div id="ec2_region-list-{{@key}}">
                {{#if vpcs}}
                  <ul class="list-group">
                    <li class="list-group-item active">{{@key}}</li>
                    {{#each vpcs}}
                      <div class="list-group-item list-sub-element">
                        {{name}}
                        {{#if network_acls}}
                          {{#each network_acls}}
                            <div class="list-group-item-text list-sub-element"><a href="javascript:browseTo('ec2_network_acl', '{{@key}}')">{{@key}}</a></div>
                          {{/each}}
                        {{/if}}
                      </div>
                    {{/each}}
                  </ul>
                {{/if}}
              </div>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="ec2_network_acls-details">
          <script id="ec2_network_acl-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            <div id="ec2_region-details-{{@key}}">
              {{#each vpcs}}
                {{#each network_acls}}
                  <div class="list-group" id="ec2_network_acl-details-{{@key}}">
                    <div class="list-group-item active">
                      <h4 class="list-group-item-heading">{{@key}}</h4>
                    </div>
                    <div class="list-group-item">
                      <h4 class="list-group-item-heading">Inbound rules</h4>
                      {{{format_network_acls inbound_network_acls 'Source'}}}
                    </div>
                    <div class="list-group-item">
                      <h4 class="list-group-item-heading">Outbound rules</h4>
                      {{{format_network_acls outbound_network_acls 'Destination'}}}
                    </div>
                  </div>
                {{/each}}
              {{/each}}
            </div>
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for EC2 VPCs -->
      <div class="row" id="ec2_vpcs-row">
        <div class="col-sm-4" id="ec2_vpcs-list">
          <script id="ec2_vpc-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('ec2_vpc')">Show all<span class="badge pull-right">{{count_in "ec2" "regions.vpcs"}}</span></a></li>
            </ul>
            {{#each items}}
              <div id="ec2_region-list-{{@key}}">
                {{#if vpcs}}
                  <ul class="list-group">
                    <li class="list-group-item active">{{@key}}</li>
                    {{#each vpcs}}
                        <div class="list-group-item-text list-sub-element" id="ec2_instance-list-{{id}}"><a href="javascript:browseTo('ec2_vpc', '{{id}}')">{{name}}</a></div>
                    {{/each}}
                  </ul>
                {{/if}}
              </div>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="ec2_vpcs-details">
          <script id="ec2_vpc-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            <div id="ec2_region-details-{{@key}}">
              {{#each vpcs}}
                    {{> ec2_vpc region=../name}}
              {{/each}}
            </div>
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->      

      <!-- Template for EC2 instances -->
      <div class="row" id="ec2_instances-row">
        <div class="col-sm-4" id="ec2_instances-list">
          <script id="ec2_instance-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('ec2_instance')">Show all<span class="badge pull-right">{{count_in "ec2" "regions.vpcs.instances"}}</span></a></li>
            </ul>
            {{#each items}}
              <div id="ec2_region-list-{{@key}}">
                {{#if vpcs}}
                  <ul class="list-group">
                    <li class="list-group-item active">{{@key}}</li>
                    {{#each vpcs}}
                      <div class="list-group-item list-sub-element">
                        {{name}}
                        {{#each instances}}
                          <div class="list-group-item-text list-sub-element" id="ec2_instance-list-{{id}}"><a href="javascript:browseTo('ec2_instance', '{{id}}')">{{name}}</a></div>
                        {{/each}}
                      </div>
                    {{/each}}
                  </ul>
                {{/if}}
              </div>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="ec2_instances-details">
          <script id="ec2_instance-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            <div id="ec2_region-details-{{@key}}">
              {{#each vpcs}}
                {{#each instances}}
                  {{> ec2_instance region=../../name}}
                {{/each}}
              {{/each}}
            </div>
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for IAM groups -->
      <div class="row" id="iam_groups-row">
        <div class="col-sm-4">
          <ul class="list-group" id="iam_groups-list">
            <script id="iam_group-list-template" type="text/x-handlebars-template">
            <li class="list-group-item"><a href="javascript:showAll('iam_group')">Show all <span class="badge pull-right">{{count items}}</span></a></li>
            {{#each items}}
              <li class="list-group-item" id="iam_group-list-{{name}}">
                <a href="javascript:browseTo('iam_group','{{name}}')">{{name}}</a>
              </li>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="iam_groups-details">
          <script id="iam_group-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            {{> iam_group}}
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for IAM permissions -->
      <div class="row" id="iam_permissions-row">
        <div id="iam_permissions-list"></div>
          <script id="iam_permission-list-template" type="text/x-handlebars-template">
          {{#each items}}
            <div class="list-group">
              <div class="row list-group-item active">
                <div class="col-sm-4"><h4>{{@key}} Permission</h4></div>
                <div class="col-sm-8"><h4>Details</h4></div>
              </div>
              {{#each this}}
                <div class="row list-group-item" id="iam_permission-details-{{@key}}">
                  <div class="col-sm-4">{{@key}}:</div>
                  <div class="col-sm-8">
                    {{#each this}}
                      {{addMember 'type' @key}}
                      <div class="list-group-item-text">{{make_title @key}}:</div>
                      <ul>
                        {{#each this}}
                          {{#ifShow @key 'type'}}
                            <li class="list-group-item-text">{{make_title @key}}:</li>
                            <ul>
                              {{#each this}}
                                {{addMember 'name' @key}}
                                <li class="list-group-item-text"><a href="javascript:{{entity_details_callback ../../../type}}('{{@key}}')">{{@key}}</a></li>
                                <ul>
                                  {{#each this}}
                                    {{#ifShow @key 'name'}}
                                      <li class="list-group-item-text">{{make_title @key}}s</li>
                                      <ul class="no-bullet">
                                        {{#each this}}
                                          {{addMember 'Resource' @key}}
                                          {{#each InlinePolicies}}
                                            <li>
                                              {{../Resource}} granted in <a href="javascript:showIAMInlinePolicy('{{../../../../../../../type}}', '{{../../../../name}}', '{{@key}}')">{{@key}}</a>
                                              {{#if condition}}
                                                <ul class="no-bullet">
                                                  <li class="list-group-item-text">Condition: {{condition}}</li>
                                                </ul>
                                              {{/if}}
                                            </li>
                                          {{/each}}
                                          {{#each ManagedPolicies}}
                                            <li>
                                              {{../Resource}} granted in <a href="javascript:showIAMManagedPolicy('{{@key}}')">{{policy_friendly_name @key}}</a>
                                              {{#if condition}}
                                                <ul class="no-bullet">
                                                  <li class="list-group-item-text">Condition: {{condition}}</li>
                                                </ul>
                                              {{/if}}
                                            </li>
                                          {{/each}}
                                        {{/each}}
                                      </ul>
                                    {{/ifShow}}
                                  {{/each}}
                                </ul>
                              {{/each}}
                            </ul>
                          {{/ifShow}}
                        {{/each}}
                      </ul>
                    {{/each}}
                  </div>
                </div>
              {{/each}}
            </div>
          {{/each}}
          </script>
      </div><!-- /.row -->

      <!-- Template for IAM root account overview -->
      <div class="row" id="iam_credential_reports-row">
        <div id="iam_credential_reports-list"></div>
          <script id="iam_credential_report-list-template" type="text/x-handlebars-template">
            <div class="list-group" id="iam_credential_report-details-">
              <div class="list-group-item active">
                <h4 class="list-group-item-heading">AWS root account</h4>
              </div>
              <div class="list-group-item">
                <div class="list-group-item-text item-margin">Creation date: {{items.user_creation_time}}</div>
                <div class="list-group-item-text item-margin">Password last used: <span id="iam_credential_report-root-active-password-">{{items.password_last_used}}</span></div>
                <div class="list-group-item-text item-margin">MFA enabled: <span id="iam_credential_report-root-no-mfa-">{{items.mfa_active}}</span></div>
                <div class="list-group-item-text item-margin">Access key 1 active: <span id="iam_credential_report-root-active-key-access_key_1_active">{{items.access_key_1_active}}</span></div>
                <div class="list-group-item-text item-margin">Access key 2 active: <span id="iam_credential_report-root-active-key-access_key_2_active">{{items.access_key_2_active}}</span></div>
                <div class="list-group-item-text item-margin">Signing cert 1 active: {{items.cert_1_active}}</div>
                <div class="list-group-item-text item-margin">Signing cert 2 active: {{items.cert_2_active}}</div>
              </div>
            </div>
          </script>
      </div><!-- /.row -->

      <!-- Template for IAM roles -->
      <div class="row" id="iam_roles-row">
        <div class="col-sm-3">
          <ul class="list-group" id="iam_roles-list">
            <script id="iam_role-list-template" type="text/x-handlebars-template">
            <li class="list-group-item"><a href="javascript:showAll('iam_role')">Show all <span class="badge pull-right">{{count items}}</span></a></li>
            {{#each items}}
              <li class="list-group-item" id="iam_role-list-{{name}}">
                <a href="javascript:browseTo('iam_role','{{name}}')">{{name}}</a>
              </li>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="iam_roles-details">
          <script id="iam_role-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            {{> iam_role}}
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for IAM users -->
      <div class="row" id="iam_users-row">
        <div class="col-sm-4">
          <ul class="list-group" id="iam_users-list">
            <script id="iam_user-list-template" type="text/x-handlebars-template">
            <li class="list-group-item"><a href="javascript:showAll('iam_user')">Show all <span class="badge pull-right">{{count items}}</span></a></li>
            {{#each items}}
              <li class="list-group-item" id="iam_user-list-{{name}}">
                <a href="javascript:browseTo('iam_user','{{name}}')">{{name}}</a>
              </li>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="iam_users-details">
          <script id="iam_user-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            {{> iam_user}}
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for RDS instances -->
      <div class="row" id="rds_instances-row">
        <div class="col-sm-4" id="rds_instances-list">
          <script id="rds_instance-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('rds_instance')">Show all<span class="badge pull-right">{{count_in "rds" "regions.instances"}}</span></a></li>
            </ul>
            {{#each items}}
              <ul class="list-group" id="rds_region-list-{{@key}}">
                <li class="list-group-item active">{{@key}}</li>
                {{#each instances}}
                  <div class="list-group-item list-sub-element">
                    <div class="list-group-item-text list-sub-element" id="rds_instance-list-{{@key}}"><a href="javascript:browseTo('rds_instance', '{{@key}}')">{{@key}}</a></div>
                  </div>
                {{/each}}
              </ul>
            {{/each}}
          </script>
        </div>
        <div class="col-sm-8" id="rds_instances-details">
          <script id="rds_instance-detail-template" type="text/x-handlebars-template">
            {{#each items}}
              <div id="rds_region-details-{{@key}}">
                {{#each instances}}
                  {{> rds_instance region=../name}}
                {{/each}}
              </div>
            {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for RDS security groups -->
      <div class="row" id="rds_security_groups-row">
        <div class="col-sm-4" id="rds_security_groups-list">
          <script id="rds_security_group-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('rds_security_group')">Show all<span class="badge pull-right">{{count_in "rds" "regions.security_groups"}}</span></a></li>
            </ul>
            {{#each items}}
              <ul class="list-group" id="rds_region-list-{{@key}}">
                <li class="list-group-item active">{{@key}}</li>
                {{#each security_groups}}
                  <div class="list-group-item list-sub-element">
                    <div class="list-group-item-text list-sub-element" id="rds_security_group-list-{{name}}"><a href="javascript:browseTo('rds_security_group', '{{name}}')">{{name}}</a></div>
                  </div>
                {{/each}}
              </ul>
            {{/each}}
          </script>
        </div>
        <div class="col-sm-8" id="rds_security_groups-details">
          <script id="rds_security_group-detail-template" type="text/x-handlebars-template">
            {{#each items}}
              <div id="rds_region-details-{{@key}}">
                {{#each security_groups}}
                  {{> rds_security_group region=../../name }}
                {{/each}}
              </div>
            {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for S3 buckets -->
      <div class="row" id="s3_buckets-row">
        <div class="col-sm-4">
          <ul class="list-group" id="s3_buckets-list">
            <script id="s3_bucket-list-template" type="text/x-handlebars-template">
            <li class="list-group-item"><a href="javascript:showAll('s3_bucket')">Show all <span class="badge pull-right">{{count items}}</span></a></li>
            {{#each items}}
              <li class="list-group-item" id="s3_bucket-list-{{@key}}">
                <a href="javascript:browseTo('s3_bucket','{{@key}}')">{{@key}}</a>
              </li>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="s3_buckets-details">
          <script id="s3_bucket-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            {{> s3_bucket}}
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <div class="row" id="about-row">
        <div class="list-group">
          <div class="row list-group-item active">
            About
          </div>
          <div class="row list-group-item">
            <p>&nbsp;</p>
            <p>AWS Scout2 is an open-source security tool release by <a href="https://www.isecpartners.com" target="_blank">iSEC Partners</a>.</p>
            <p>&nbsp;</p>
            <p>Use the top navigation bar to review the configuration of the
            supported AWS services. For more information about Scout2, please
            check out the project's page on
            <a href="https://github.com/iSECPartners/Scout2" target="_blank">Github</a>
            and the project's website at
            <a href="https://isecpartners.github.io/Scout2/" target="_blank">https://isecpartners.github.io/Scout2/</a>.
            <p>&nbsp;</p>
            The AWS documentation is available at
            <a href="https://aws.amazon.com/documentation" target="_blank">https://aws.amazon.com/documentation</a>.
            </p>
          </div>
        </div>
      </div>

      <div class="row" id="please_wait-row">
        <div class="list-group">
          <div class="row list-group-item active">
            Please wait
          </div>
          <div class="row list-group-item">
            <p>&nbsp;</p>
            <p>Loading data, this may take a while...</p>
            <p>&nbsp;</p>
          </div>
        </div>
      </div>


    </div> <!-- /container -->

    <!-- Include all AWS services configs -->
    <script src="inc-awsconfig/cloudtrail_config.js"></script>
    <script src="inc-awsconfig/ec2_config.js"></script>
    <script src="inc-awsconfig/iam_config.js"></script>
    <script src="inc-awsconfig/rds_config.js"></script>
    <script src="inc-awsconfig/s3_config.js"></script>

    <!-- Bootstrap core JavaScript, placed at the end of the document so the pages load faster -->
    <script src="inc-bootstrap/js/bootstrap.min.js"></script>

    <!-- Hide the please wait message -->
    <script>$('#please_wait-row').hide();</script>

  </body>
</html>
